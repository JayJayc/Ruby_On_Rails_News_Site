{"filter":false,"title":"api_controller.rb","tooltip":"/app/controllers/api_controller.rb","undoManager":{"mark":31,"position":31,"stack":[[{"start":{"row":0,"column":7},"end":{"row":0,"column":17},"action":"remove","lines":["pplication"],"id":2},{"start":{"row":0,"column":7},"end":{"row":0,"column":8},"action":"insert","lines":["p"]}],[{"start":{"row":0,"column":8},"end":{"row":0,"column":9},"action":"insert","lines":["i"],"id":3}],[{"start":{"row":0,"column":38},"end":{"row":0,"column":44},"action":"remove","lines":["::Base"],"id":4}],[{"start":{"row":0,"column":22},"end":{"row":0,"column":38},"action":"remove","lines":["ActionController"],"id":5},{"start":{"row":0,"column":22},"end":{"row":0,"column":43},"action":"insert","lines":["ApplicationController"]}],[{"start":{"row":1,"column":2},"end":{"row":5,"column":0},"action":"remove","lines":["# Prevent CSRF attacks by raising an exception.","  # For APIs, you may want to use :null_session instead.","  protect_from_forgery with: :exception","end",""],"id":6},{"start":{"row":1,"column":2},"end":{"row":20,"column":7},"action":"insert","lines":["    before_filter :parse_request, :authenticate_user_from_token!","","    private","       def authenticate_user_from_token!","         if !@json['api_token']","           render nothing: true, status: :unauthorized","         else","           @user = nil","           User.find_each do |u|","             if Devise.secure_compare(u.api_token, @json['api_token'])","               @user = u","             end","           end","         end","       end","","       def parse_request","         @json = JSON.parse(request.body.read)","       end","    end"]}],[{"start":{"row":1,"column":4},"end":{"row":1,"column":6},"action":"remove","lines":["  "],"id":7}],[{"start":{"row":20,"column":0},"end":{"row":20,"column":2},"action":"remove","lines":["  "],"id":8}],[{"start":{"row":20,"column":0},"end":{"row":20,"column":2},"action":"remove","lines":["  "],"id":9}],[{"start":{"row":3,"column":2},"end":{"row":3,"column":4},"action":"remove","lines":["  "],"id":10}],[{"start":{"row":4,"column":0},"end":{"row":4,"column":2},"action":"remove","lines":["  "],"id":11}],[{"start":{"row":5,"column":6},"end":{"row":5,"column":8},"action":"remove","lines":["  "],"id":12}],[{"start":{"row":6,"column":4},"end":{"row":6,"column":6},"action":"remove","lines":["  "],"id":13}],[{"start":{"row":7,"column":2},"end":{"row":7,"column":4},"action":"remove","lines":["  "],"id":14}],[{"start":{"row":8,"column":0},"end":{"row":8,"column":2},"action":"remove","lines":["  "],"id":15}],[{"start":{"row":8,"column":20},"end":{"row":9,"column":0},"action":"remove","lines":["",""],"id":16}],[{"start":{"row":8,"column":22},"end":{"row":8,"column":31},"action":"remove","lines":["         "],"id":17},{"start":{"row":8,"column":22},"end":{"row":9,"column":0},"action":"insert","lines":["",""]},{"start":{"row":9,"column":0},"end":{"row":9,"column":9},"action":"insert","lines":["         "]}],[{"start":{"row":10,"column":8},"end":{"row":10,"column":9},"action":"remove","lines":[" "],"id":18}],[{"start":{"row":11,"column":6},"end":{"row":11,"column":8},"action":"remove","lines":["  "],"id":19}],[{"start":{"row":12,"column":4},"end":{"row":12,"column":6},"action":"remove","lines":["  "],"id":20}],[{"start":{"row":10,"column":2},"end":{"row":10,"column":4},"action":"remove","lines":["  "],"id":21}],[{"start":{"row":13,"column":4},"end":{"row":13,"column":6},"action":"remove","lines":["  "],"id":22}],[{"start":{"row":14,"column":2},"end":{"row":14,"column":4},"action":"remove","lines":["  "],"id":23}],[{"start":{"row":15,"column":0},"end":{"row":15,"column":2},"action":"remove","lines":["  "],"id":24}],[{"start":{"row":17,"column":4},"end":{"row":17,"column":6},"action":"remove","lines":["  "],"id":25}],[{"start":{"row":18,"column":2},"end":{"row":18,"column":4},"action":"remove","lines":["  "],"id":26}],[{"start":{"row":19,"column":0},"end":{"row":19,"column":2},"action":"remove","lines":["  "],"id":27}],[{"start":{"row":12,"column":10},"end":{"row":12,"column":11},"action":"remove","lines":[" "],"id":28}],[{"start":{"row":11,"column":12},"end":{"row":11,"column":13},"action":"remove","lines":[" "],"id":29}],[{"start":{"row":1,"column":2},"end":{"row":1,"column":3},"action":"remove","lines":[" "],"id":30}],[{"start":{"row":1,"column":2},"end":{"row":1,"column":3},"action":"remove","lines":[" "],"id":31}],[{"start":{"row":15,"column":8},"end":{"row":16,"column":0},"action":"remove","lines":["",""],"id":32}],[{"start":{"row":15,"column":8},"end":{"row":16,"column":0},"action":"insert","lines":["",""],"id":33},{"start":{"row":16,"column":0},"end":{"row":16,"column":5},"action":"insert","lines":["     "]}]]},"ace":{"folds":[],"scrolltop":0,"scrollleft":0,"selection":{"start":{"row":20,"column":3},"end":{"row":20,"column":3},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":0},"timestamp":1525966416248,"hash":"66bce6b1eec70a3e5cde3ed8c9501bddd9c057d6"}